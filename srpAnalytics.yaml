# =========================================================
# srpAnalytics : SCHEMA FOR SUPERFUND RESEARCH PORTAL
# =========================================================
id: http://w3id.org/linkml/examples/srpanalytics
name: srpanalytics
prefixes:
   linkml: https://w3id.org/linkml
   srpanalytics: https://w3id.org/linkml/examples/srpanalytics
   schema: http://schema.org/
imports:
   - linkml:types
default_range: string
default_prefix: srpanalytics

# ---------------------------------------------------------
# Slots
# ---------------------------------------------------------
slots:
  AUC_Norm:
    description: normalized area under the curve
    range: linkml:Any
  bmdrc.Endpoint.ID:
    description: bmdrc package identifier for endpoint, typically Chemical_ID + End_Point
  BMD_Analysis_Flag:
    description: quality of curve fit
    range: integer
  BMD10:
    description: Dose at which 10% of fish are affected
    range: linkml:Any
  BMD50:
    description: Dose at which 50% of fish are affected
    range: linkml:Any
  Chemical_ID:
    description: Unique identifier for every chemical in the database
    range: integer
    identifier: true
    slot_uri: schema:identifier
  DataQC_Flag:
    description: Quality of Data
    range: integer
  Description:
    description: Name of endpoint
  End_Point:
    description: Name of endpoint
  cas_number:
    description: CAS identifier for a specific chemical
    range: linkml:Any  # need to enforce string
  CI_Hi:
    description: High range of confidence interval
    range: float
  CI_Lo:
    description: Low range of confidence interval
    range: float
  concentration:
    description: Concentration at which chemical was administered in uM
    range: float
  concentration_unit:
    description: Unit of concentration
  Dose:
    description: Dose of chemical
    range: float
  Max_Dose:
    description: Maximum dose administered
    range: linkml:Any
  Min_Dose:
    description: Minimum dose administered
    range: linkml:Any
  Model:
    description: Model with best fit to data
  Project:
    description: name of project contributing the dataset
  Sample_ID:
    description: Unique identifier for every sample in the database
    range: linkml:Any
    identifier: true
    slot_uri: schema:identifier
  X_vals:
    description: X coordinates of fitted curve, if available
    range: linkml:Any
  Y_vals:
    description: Y coordinates of fitted curve, if available
    range: linkml:Any
  # endPointLink:
  #   description: Link to endpoint description
  # combined:
  #   description: (TODO) Combined significance score?
    # range: linkml:Any  # float
    # IncludeInPortal:
  #   description:
  # Response: -> Normalized_to_Vehicle
  #   description: Response in terms of percentage of fish alive
    # range: float

# ---------------------------------------------------------
# Data Classes
# ---------------------------------------------------------
classes:
  samples:
    description: List of samples collected in the Superfund study
    slots:
      - Sample_ID
      - projectName
    attributes:
      ClientName:
        description: Name of client
      SampleNumber:
        description: SampleNumber value from LIMS
      date_sampled:
        description: Date sampled in [day]/[month]/[year] [hh:mm:ss] [AM|PM] format
      date_sample_start:
        description:
        range: linkml:Any
      sample_matrix:
        description:
      technology:
        description:
      projectName:
        description:
      LocationLat:
        description:
        range: float
      LocationLon:
        description:
        range: float
      projectLink:
        description:
      LocationAlternateDescription:
        description:
      LocationName:
        description:
      SampleName:
        description:
      AlternateName:
        description:
  chemicals:
    description: List of chemicals measured in the Superfund study
    slots:
      - cas_number
      - Chemical_ID
    attributes:
      preferredName:
        description: Chemical name
      smiles:
        description: SMILES representation of a chemical compound
      dtxsid:
        description: DSSTox Substance Identifier used in the Environmental Protection Agency CompTox Dashboard
      dtxcid:
        description: DSSTox Compound Identifier used in the Environmental Protection Agency CompTox Dashboard
      averageMass:   
        description: Average molecular mass of a chemical compound
        range: linkml:Any
      inchikey:
        description: InChIKey identifier for a chemical compound
      molFormula:
        description: Molecular formula
      PUBCHEM_DATA_SOURCES:
        description: Number of data sources in pubchem citing this chemical
        range: float
      chem_source:
        description: Source of chemical, from hand-curated list at OSU.
      chemical_class:
        description: Chemical class, from hand-curated list at OSU
      chemDescription:
        description:
      image_link:
        description: Link to image of molecular structure
        range:
  samplesToChemicals: 
    description: Measurements of chemicals in samples
    slots:
      - Sample_ID
      - Chemical_ID
      - cas_number
    attributes:
      measurement_value:
        description: Value measured in sampler
        range: linkml:Any
      measurement_value_qualifier:
        description: Qualifier of sample measurement
      measurement_value_unit:
        description: Unit of sample measurement
      measurement_value_molar:
        description: Value converted to molar. 
        range: linkml:Any
      measurement_value_molar_unit:
        description:
        range: linkml:Any
      environmental_concentration:
        description:
        range: linkml:Any
      environmental_concentration_qualifier:
        description:
      environmental_concentration_unit:
        description:
      environmental_concentration_molar:
        description:
        range: linkml:Any
      environmental_concentration_molar_unit:
        description:
  BMDs:
    description: Benchmark dose measurements
    slots:
      - Chemical_ID
      - End_Point
      - Model
      - BMD10
      - BMD50
      - Min_Dose
      - Max_Dose
      - AUC_Norm
      - DataQC_Flag
      - BMD_Analysis_Flag
    attributes:
      AUC:
        description: Area under curve
        range: float
      BMD10_Flag:
        description: Flag for BMD10
        range: integer
      BMD50_Flag:
        description: Flag for BMD50
        range: integer
      BMDL:
        description: Lowest dose at which fish were affected
        range: float
  Dose:
    description: Dose response datapoints
    slots:
      - Chemical_ID
      - End_Point
      - Dose
      - CI_Lo
      - CI_Hi
    # attributes:
    #   num.affected:
    #     description: Number of fish with the observed phenotype
    #     range: integer
    #   num.nonna:
    #     description: Number of fish measured for the given endpoint
    #     range: integer
  Fits:
    description: XY Coordinates of curve fit data
    slots:
      - Chemical_ID
      - End_Point
      - X_vals
      - Y_vals
  zebrafishChemBMDs:
    description: Benchmark dose measurements of chemical extracts in zebrafish
    is_a: BMDs
    slots:
      - bmdrc.Endpoint.ID
  zebrafishChemDose:
    description: Dose response datapoints of chemical extracts in zebrafish
    is_a: Dose
    slots:
      - bmdrc.Endpoint.ID
    attributes:
      num.affected:
        description: Number of fish with the observed phenotype
        range: integer
      num.nonna:
        description: Number of fish measured for the given endpoint
        range: integer
  zebrafishChemFits:
    description: XY Coordinates of curve fit data for chemical extracts in zebrafish
    is_a: Fits
    slots:
      - bmdrc.Endpoint.ID
  zebrafishSampBMDs:
    description: Benchmark dose measurements of sample extracts in zebrafish
    is_a: BMDs
  zebrafishSampDose:  # new_Dose_BC/LPR
    description: Dose response datapoints of sample extracts in zebrafish
    is_a: Dose
    attributes:
      Response: # -> Normalized_to_Vehicle
        description: Response in terms of percentage of fish alive
        range: float
  zebrafishSampFits:  # new_Fits_BC/LPR
    description: XY Coordinates of curve fit data for sample extracts in zebrafish
    is_a: Fits
  allGeneEx:
    description: List of all experiments that measure gene expression changes in zebrafish upon chemical treatment changes
    slots:
      - Project
      - cas_number
      - Chemical_ID
      - concentration
    attributes:
      Gene:
        description:
        range: linkml:Any
      GeneID:
        description:
      adj_p_value:
        description:
        range: float
      indication:
        description:
        range: integer
      Log2FoldChange:
        description: fold change
        range: float
  srpDEGStats:
    description: Summary statistics
    slots:
      - Project
      - cas_number
      - Chemical_ID
      - concentration
    attributes:
      link:
        description: Link to experiment?
      DownRegulatedGenes:
        description: number of genes down-regulated upon chemical treatement
        range: integer
      UpRegulatedGenes:
        description: number of genes up-regulated upon chemical treatement
        range: integer
  srpDEGPathways:
    description: Pathways that are enriched in zebrafish genes that are differentially expressed upon treatment with a chemical
    slots:
      - Chemical_ID
      - concentration
    attributes:
      term:
        description:
        range: string
      z_score:
        description:
        range: float
      enrichment_score:
        description:
        range: float
      overlap:
        description:
        range: string
      p_value:
        description:
        range: float
      adj_p_value:
        description:
        range: float
      Genes:
        description:
        range: string
      toPlot:
        description:
        range: integer    
  exposomeGeneStats:
    description: Summary and link to exposome measurements of human genes that are differentailly expressed upon chemical treatment
    slots:
      - Chemical_ID
      - Project
      - concentration
      - cas_number
      - concentration_unit
    attributes:
      Link:
        description: Link to Exposome website at Boston University
      Condition:
        description:
      nGenes:
        description:
        range: integer
